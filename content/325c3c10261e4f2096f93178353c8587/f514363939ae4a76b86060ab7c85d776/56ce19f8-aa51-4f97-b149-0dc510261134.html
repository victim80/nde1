<div class="eg-content-editor" data-type="imageEditorOneColumn"><div class="column">
  <div class="cropped-image" style="position:relative;overflow: hidden;padding-top: 20.56818181818182%">
    <img style="position: absolute; top: 50%;left: 50%;transform: translate(-50%, -50%);max-width: 100%; max-height: 100%;" src="https://files-storage.easygenerator.com/image/018f5d48-0e71-4740-b097-a9bc16bc397a.png" alt="" data-src="https://files-storage.easygenerator.com/image/afd5c8fc-0b09-4fce-a866-32ec37244e23.png" data-init="{&quot;w&quot;:880,&quot;h&quot;:181.00000000000003,&quot;y&quot;:0,&quot;x&quot;:-135,&quot;defaultScale&quot;:2,&quot;scale&quot;:1}">
  </div>
  <div class="row" data-content-type="TextEditor"><p style="text-align:center;">Figure 5.90: ESP in the transport mode</p><p style="text-align:justify;"><strong>Tunnel Mode</strong></p><p style="text-align:justify;">In the tunnel mode, IPsec encrypts both the IP payload and the header to protect an entire IP packet by encapsulating it with an AH or ESP header and an additional IP header. This mode is useful for protecting traffic between different networks and is primarily used for interoperability with gateways.</p><p style="text-align:justify;">The tunnel mode of IPsec is generally implemented in configurations such as gateway-to-gateway, server-to-gateway, and server-to-server configurations. The IPsec tunnel mode is useful in protecting traffic while it is passing through untrusted networks.</p><ul><li style="text-align:justify;"><strong>AH in tunnel mode</strong>: The AH header can be used individually or along with ESP. It defends the entire packet. However, AH does not safeguard all the fields of the new IP header in case of some change in transit. Nevertheless, it safeguards everything that does not change in transit. AH is recognized in the new IP header with an IP protocol ID of 51.</li></ul></div>
</div></div>